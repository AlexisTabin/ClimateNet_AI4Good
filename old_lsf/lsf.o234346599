Running on euler with following parameters : 
User : atabin
Model : cgnet
Data folder : /cluster/work/igp_psr/ai4good/group-1b/data/
Saving directory : /cluster/scratch/atabin/cgnet/
Checkpoint path : /cluster/scratch/atabin/checkpoints/cgnet/
  0%|          | 0/10 [00:00<?, ?it/s]{'model': 'cgnet', 'data_dir': '/cluster/work/igp_psr/ai4good/group-1b/data/', 'checkpoint_path': '/cluster/scratch/atabin/checkpoints/cgnet/', 'save_dir': '/cluster/scratch/atabin/cgnet/'}
Running baseline example...
train_path :  /cluster/work/igp_psr/ai4good/group-1b/data/train/
val_path :  /cluster/work/igp_psr/ai4good/group-1b/data/val/
inference_path :  /cluster/work/igp_psr/ai4good/group-1b/data/test/
Loading data...
evaluating on val set...
 10%|█         | 1/10 [00:12<01:56, 12.99s/it] 20%|██        | 2/10 [00:15<01:19,  9.89s/it] 30%|███       | 3/10 [00:16<00:49,  7.07s/it] 40%|████      | 4/10 [00:16<00:30,  5.09s/it] 50%|█████     | 5/10 [00:18<00:21,  4.25s/it] 60%|██████    | 6/10 [00:19<00:13,  3.30s/it] 70%|███████   | 7/10 [00:20<00:07,  2.47s/it] 80%|████████  | 8/10 [00:21<00:03,  1.89s/it] 90%|█████████ | 9/10 [00:22<00:01,  1.67s/it]100%|██████████| 10/10 [00:23<00:00,  1.49s/it]100%|██████████| 10/10 [00:23<00:00,  2.34s/it]
  0%|          | 0/8 [00:00<?, ?it/s]Evaluation stats:
[[6.4413865e+07 1.7021900e+05 2.2578000e+06]
 [1.1337800e+05 1.7131100e+05 3.8620000e+03]
 [1.1576790e+06 1.5220000e+04 2.4755460e+06]]
IOUs:  [0.94569202 0.36142324 0.41886653] , mean:  0.5753272628002115
evaluating on test data...
 12%|█▎        | 1/8 [00:06<00:42,  6.13s/it] 25%|██▌       | 2/8 [00:07<00:29,  4.85s/it] 38%|███▊      | 3/8 [00:08<00:17,  3.55s/it] 50%|█████     | 4/8 [00:09<00:10,  2.64s/it] 62%|██████▎   | 5/8 [00:10<00:06,  2.30s/it] 75%|███████▌  | 6/8 [00:12<00:04,  2.12s/it] 88%|████████▊ | 7/8 [00:12<00:01,  1.66s/it]100%|██████████| 8/8 [00:13<00:00,  1.27s/it]100%|██████████| 8/8 [00:13<00:00,  1.66s/it]
  0%|          | 0/8 [00:00<?, ?it/s] 12%|█▎        | 1/8 [00:01<00:11,  1.67s/it] 25%|██▌       | 2/8 [00:03<00:09,  1.61s/it] 38%|███▊      | 3/8 [00:04<00:07,  1.57s/it] 50%|█████     | 4/8 [00:06<00:06,  1.54s/it] 62%|██████▎   | 5/8 [00:07<00:04,  1.52s/it] 75%|███████▌  | 6/8 [00:09<00:03,  1.51s/it] 88%|████████▊ | 7/8 [00:10<00:01,  1.49s/it]100%|██████████| 8/8 [00:11<00:00,  1.33s/it]100%|██████████| 8/8 [00:11<00:00,  1.43s/it]Evaluation stats:
[[4.8936119e+07 1.0896000e+05 1.6092230e+06]
 [1.4830600e+05 1.4584000e+05 2.4480000e+03]
 [1.1369140e+06 1.2873000e+04 1.8682130e+06]]
IOUs:  [0.942175   0.34854347 0.4035304 ] , mean:  0.564749624294388
identifying connected components..

tracking components across time..
  0%|          | 0/61 [00:00<?, ?it/s]  2%|▏         | 1/61 [00:01<01:53,  1.89s/it]  3%|▎         | 2/61 [00:03<01:41,  1.72s/it]  5%|▍         | 3/61 [00:04<01:28,  1.52s/it]  7%|▋         | 4/61 [00:05<01:20,  1.41s/it]  8%|▊         | 5/61 [00:06<01:18,  1.41s/it] 10%|▉         | 6/61 [00:08<01:14,  1.35s/it] 11%|█▏        | 7/61 [00:09<01:09,  1.28s/it] 13%|█▎        | 8/61 [00:10<01:06,  1.25s/it] 15%|█▍        | 9/61 [00:11<01:00,  1.17s/it] 16%|█▋        | 10/61 [00:12<01:05,  1.29s/it] 18%|█▊        | 11/61 [00:13<01:01,  1.23s/it] 20%|█▉        | 12/61 [00:15<01:02,  1.27s/it] 21%|██▏       | 13/61 [00:16<00:59,  1.25s/it] 23%|██▎       | 14/61 [00:17<00:58,  1.24s/it] 25%|██▍       | 15/61 [00:18<00:53,  1.15s/it] 26%|██▌       | 16/61 [00:20<00:54,  1.22s/it] 28%|██▊       | 17/61 [00:21<00:55,  1.26s/it] 30%|██▉       | 18/61 [00:22<00:54,  1.26s/it] 31%|███       | 19/61 [00:23<00:51,  1.24s/it] 33%|███▎      | 20/61 [00:24<00:47,  1.16s/it] 34%|███▍      | 21/61 [00:26<00:48,  1.22s/it] 36%|███▌      | 22/61 [00:27<00:45,  1.18s/it] 38%|███▊      | 23/61 [00:28<00:47,  1.24s/it] 39%|███▉      | 24/61 [00:29<00:43,  1.17s/it] 41%|████      | 25/61 [00:31<00:44,  1.23s/it] 43%|████▎     | 26/61 [00:32<00:42,  1.21s/it] 44%|████▍     | 27/61 [00:33<00:40,  1.21s/it] 46%|████▌     | 28/61 [00:34<00:38,  1.17s/it] 48%|████▊     | 29/61 [00:35<00:36,  1.13s/it] 49%|████▉     | 30/61 [00:37<00:39,  1.27s/it] 51%|█████     | 31/61 [00:38<00:38,  1.28s/it] 52%|█████▏    | 32/61 [00:39<00:34,  1.19s/it] 54%|█████▍    | 33/61 [00:40<00:32,  1.15s/it] 56%|█████▌    | 34/61 [00:41<00:33,  1.25s/it] 57%|█████▋    | 35/61 [00:43<00:32,  1.26s/it] 59%|█████▉    | 36/61 [00:44<00:30,  1.22s/it] 61%|██████    | 37/61 [00:45<00:29,  1.24s/it] 62%|██████▏   | 38/61 [00:46<00:29,  1.26s/it] 64%|██████▍   | 39/61 [00:48<00:27,  1.25s/it] 66%|██████▌   | 40/61 [00:49<00:26,  1.27s/it] 67%|██████▋   | 41/61 [00:50<00:24,  1.23s/it] 69%|██████▉   | 42/61 [00:51<00:22,  1.19s/it] 70%|███████   | 43/61 [00:52<00:20,  1.14s/it] 72%|███████▏  | 44/61 [00:54<00:20,  1.22s/it] 74%|███████▍  | 45/61 [00:55<00:19,  1.22s/it] 75%|███████▌  | 46/61 [00:56<00:18,  1.25s/it] 77%|███████▋  | 47/61 [00:58<00:17,  1.27s/it] 79%|███████▊  | 48/61 [00:59<00:16,  1.23s/it] 80%|████████  | 49/61 [01:00<00:15,  1.27s/it] 82%|████████▏ | 50/61 [01:01<00:13,  1.21s/it] 84%|████████▎ | 51/61 [01:02<00:12,  1.23s/it] 85%|████████▌ | 52/61 [01:04<00:10,  1.21s/it] 87%|████████▋ | 53/61 [01:05<00:09,  1.21s/it] 89%|████████▊ | 54/61 [01:06<00:08,  1.25s/it] 90%|█████████ | 55/61 [01:07<00:07,  1.29s/it] 92%|█████████▏| 56/61 [01:09<00:06,  1.28s/it] 93%|█████████▎| 57/61 [01:10<00:05,  1.35s/it] 95%|█████████▌| 58/61 [01:11<00:03,  1.27s/it] 97%|█████████▋| 59/61 [01:13<00:02,  1.29s/it] 98%|█████████▊| 60/61 [01:14<00:01,  1.23s/it]100%|██████████| 61/61 [01:14<00:00,  1.07s/it]100%|██████████| 61/61 [01:14<00:00,  1.23s/it]num TCs: 6
num ARs: 16
calculating centroids..

extracting event types..
calculating genesis and termination frequencies..
generating histograms..
generating frequency maps..
visualizing frequency map : Genesis frequency map of TCs
initializing.. Genesis frequency map of TCs
drawing frequencies.. Genesis frequency map of TCs
drawing colorbar.. Genesis frequency map of TCs
drawing legend.. Genesis frequency map of TCs
saving.. Genesis frequency map of TCs
visualizing frequency map : Genesis frequency map of ARs
initializing.. Genesis frequency map of ARs
drawing frequencies.. Genesis frequency map of ARs
drawing colorbar.. Genesis frequency map of ARs
drawing legend.. Genesis frequency map of ARs
saving.. Genesis frequency map of ARs
visualizing frequency map : Termination frequency map of TCs
initializing.. Termination frequency map of TCs
drawing frequencies.. Termination frequency map of TCs
drawing colorbar.. Termination frequency map of TCs
drawing legend.. Termination frequency map of TCs
saving.. Termination frequency map of TCs
visualizing frequency map : Termination frequency map of ARs
initializing.. Termination frequency map of ARs
drawing frequencies.. Termination frequency map of ARs
drawing colorbar.. Termination frequency map of ARs
drawing legend.. Termination frequency map of ARs
saving.. Termination frequency map of ARs
visualizing frequency map : Global frequency map of TCs
initializing.. Global frequency map of TCs
drawing frequencies.. Global frequency map of TCs
drawing colorbar.. Global frequency map of TCs
drawing legend.. Global frequency map of TCs
saving.. Global frequency map of TCs
visualizing frequency map : Global frequency map of ARs
initializing.. Global frequency map of ARs
drawing frequencies.. Global frequency map of ARs
drawing colorbar.. Global frequency map of ARs
drawing legend.. Global frequency map of ARs
saving.. Global frequency map of ARs
Visualizing events...
generating images..
Error when visualizing events :  index 2 is out of bounds for axis 0 with size 1




traceback :  multiprocessing.pool.RemoteTraceback: 
"""
Traceback (most recent call last):
  File "/cluster/home/atabin/miniconda3/envs/climatenet/lib/python3.8/multiprocessing/pool.py", line 125, in worker
    result = (True, func(*args, **kwds))
  File "/cluster/home/atabin/miniconda3/envs/climatenet/lib/python3.8/multiprocessing/pool.py", line 48, in mapstar
    return list(map(*args))
  File "/cluster/home/atabin/ClimateNet_AI4Good/climatenet/visualize_events.py", line 95, in spawn
    generatePNG(filename, input_data[int(i/8)].sel(variable="TMQ")[i%8],
  File "/cluster/home/atabin/miniconda3/envs/climatenet/lib/python3.8/site-packages/xarray/core/dataarray.py", line 701, in __getitem__
    return self.isel(indexers=self._item_key_to_dict(key))
  File "/cluster/home/atabin/miniconda3/envs/climatenet/lib/python3.8/site-packages/xarray/core/dataarray.py", line 1106, in isel
    variable = self._variable.isel(indexers, missing_dims=missing_dims)
  File "/cluster/home/atabin/miniconda3/envs/climatenet/lib/python3.8/site-packages/xarray/core/variable.py", line 1120, in isel
    return self[key]
  File "/cluster/home/atabin/miniconda3/envs/climatenet/lib/python3.8/site-packages/xarray/core/variable.py", line 769, in __getitem__
    data = as_indexable(self._data)[indexer]
  File "/cluster/home/atabin/miniconda3/envs/climatenet/lib/python3.8/site-packages/xarray/core/indexing.py", line 1302, in __getitem__
    return array[key]
IndexError: index 2 is out of bounds for axis 0 with size 1
"""

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/cluster/home/atabin/ClimateNet_AI4Good/climatenet/trained_cgnet/trained_cgnet.py", line 62, in run
    visualize_events(event_masks, inference, save_dir + 'pngs/')
  File "/cluster/home/atabin/ClimateNet_AI4Good/climatenet/visualize_events.py", line 99, in visualize_events
    pool.map(spawn, range(len(event_masks))) # this line is crashing
  File "/cluster/home/atabin/miniconda3/envs/climatenet/lib/python3.8/multiprocessing/pool.py", line 364, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/cluster/home/atabin/miniconda3/envs/climatenet/lib/python3.8/multiprocessing/pool.py", line 771, in get
    raise self._value
IndexError: index 2 is out of bounds for axis 0 with size 1

Generating PNG for  /cluster/scratch/atabin/cgnet/pngs/0032.png
Contouring...
Contouring events...
Adding colorbar and legend...
Saving figure...
Generating PNG for  /cluster/scratch/atabin/cgnet/pngs/0000.png
Contouring...
Contouring events...
Adding colorbar and legend...
Saving figure...
Generating PNG for  /cluster/scratch/atabin/cgnet/pngs/0056.png
Contouring...
Contouring events...
Adding colorbar and legend...
Saving figure...
Generating PNG for  /cluster/scratch/atabin/cgnet/pngs/0048.png
Contouring...
Contouring events...
Adding colorbar and legend...
Saving figure...
Generating PNG for  /cluster/scratch/atabin/cgnet/pngs/0024.png
Contouring...
Contouring events...
Adding colorbar and legend...
Saving figure...
Generating PNG for  /cluster/scratch/atabin/cgnet/pngs/0008.png
Contouring...
Contouring events...
Adding colorbar and legend...
Saving figure...
Generating PNG for  /cluster/scratch/atabin/cgnet/pngs/0040.png
Contouring...
Contouring events...
Adding colorbar and legend...
Saving figure...
Generating PNG for  /cluster/scratch/atabin/cgnet/pngs/0016.png
Contouring...
Contouring events...
Adding colorbar and legend...
Saving figure...
Done!
