self.device :  cuda
train_path :  /cluster/work/igp_psr/ai4good/group-1b/data/train/
val_path :  /cluster/work/igp_psr/ai4good/group-1b/data/val/
inference_path :  /cluster/work/igp_psr/ai4good/group-1b/data/test/
Loading data...
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |    2064 KB |    2064 KB |    2064 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2064 KB |    2064 KB |    2064 KB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |    2064 KB |    2064 KB |    2064 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    2064 KB |    2064 KB |    2064 KB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |    2032 KB |    2045 KB |    4087 KB |    2055 KB |
|       from large pool |       0 KB |       0 KB |       0 KB |       0 KB |
|       from small pool |    2032 KB |    2045 KB |    4087 KB |    2055 KB |
|---------------------------------------------------------------------------|
| Allocations           |     498    |     498    |     498    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     498    |     498    |     498    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     498    |     498    |     498    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |     498    |     498    |     498    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       2    |       2    |       2    |       0    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       1    |       2    |       2    |       1    |
|       from large pool |       0    |       0    |       0    |       0    |
|       from small pool |       1    |       2    |       2    |       1    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Epoch 1:
Epoch stats:
[[2.42383508e+08 1.95491200e+06 1.93403950e+07]
 [7.97442000e+05 3.66418000e+05 1.73936000e+05]
 [6.02709000e+06 1.20061000e+05 1.01822860e+07]]
IOUs:  [0.89604624 0.10736677 0.2840741 ] , mean:  0.4291623715260006
Epoch 2:
Epoch stats:
[[2.52574418e+08 7.00432000e+05 1.04039650e+07]
 [5.90717000e+05 6.50783000e+05 9.62960000e+04]
 [5.88214500e+06 7.48200000e+04 1.03724720e+07]]
IOUs:  [0.93493559 0.30798307 0.38660413] , mean:  0.5431742616618683
Epoch 3:
Epoch stats:
[[2.52743297e+08 8.00458000e+05 1.01350600e+07]
 [5.41795000e+05 7.04582000e+05 9.14190000e+04]
 [5.60682000e+06 8.08070000e+04 1.06418100e+07]]
IOUs:  [0.93668497 0.31751358 0.40073218] , mean:  0.5516435734747245
Epoch 4:
Epoch stats:
[[2.52926352e+08 8.08869000e+05 9.94359400e+06]
 [5.20385000e+05 7.28015000e+05 8.93960000e+04]
 [5.45150200e+06 6.93020000e+04 1.08086330e+07]]
IOUs:  [0.93797772 0.32853152 0.41000144] , mean:  0.5588368935686915
Epoch 5:
Epoch stats:
[[2.53159665e+08 8.31008000e+05 9.68814200e+06]
 [4.97747000e+05 7.55059000e+05 8.49900000e+04]
 [5.37528800e+06 7.29590000e+04 1.08811900e+07]]
IOUs:  [0.93918727 0.33681482 0.4168628 ] , mean:  0.564288295071309
Epoch 6:
Epoch stats:
[[2.52983753e+08 8.57151000e+05 9.83791100e+06]
 [4.79259000e+05 7.80056000e+05 7.84810000e+04]
 [5.12989200e+06 6.88510000e+04 1.11306940e+07]]
IOUs:  [0.93945436 0.34457845 0.42409382] , mean:  0.5693755430513124
Epoch 7:
Epoch stats:
[[2.53218253e+08 8.30987000e+05 9.62957500e+06]
 [4.81145000e+05 7.79733000e+05 7.69180000e+04]
 [5.05061200e+06 6.91330000e+04 1.12096920e+07]]
IOUs:  [0.9405955  0.34841924 0.43054702] , mean:  0.5731872541117998
Epoch 8:
Epoch stats:
[[2.53367487e+08 8.62106000e+05 9.44922200e+06]
 [4.57347000e+05 8.03298000e+05 7.71510000e+04]
 [4.90158700e+06 6.64050000e+04 1.13614450e+07]]
IOUs:  [0.94175441 0.35445242 0.43941555] , mean:  0.5785407941299625
Epoch 9:
Epoch stats:
[[2.53628385e+08 8.54832000e+05 9.19559800e+06]
 [4.54531000e+05 8.08293000e+05 7.49720000e+04]
 [4.92424400e+06 6.94100000e+04 1.13357830e+07]]
IOUs:  [0.94265464 0.35732954 0.4428039 ] , mean:  0.5809293602866707
Epoch 10:
Epoch stats:
[[2.53389855e+08 8.57395000e+05 9.43156500e+06]
 [4.42788000e+05 8.12633000e+05 8.23750000e+04]
 [4.82746100e+06 6.95370000e+04 1.14324390e+07]]
IOUs:  [0.94214812 0.35882146 0.44237404] , mean:  0.5811145377023319
Epoch 11:
Epoch stats:
[[2.53564964e+08 8.58463000e+05 9.25538800e+06]
 [4.41304000e+05 8.17594000e+05 7.88980000e+04]
 [4.61017000e+06 6.89890000e+04 1.16502780e+07]]
IOUs:  [0.94356674 0.36092913 0.453959  ] , mean:  0.5861516260161288
Epoch 12:
Epoch stats:
[[2.53568979e+08 8.62053000e+05 9.24778300e+06]
 [4.37344000e+05 8.20489000e+05 7.99630000e+04]
 [4.60277500e+06 6.84830000e+04 1.16581790e+07]]
IOUs:  [0.94362156 0.36171469 0.45438266] , mean:  0.5865729674428503
Epoch 13:
Epoch stats:
[[2.53804546e+08 8.08454000e+05 9.06581500e+06]
 [4.37954000e+05 8.20756000e+05 7.90860000e+04]
 [4.52442200e+06 7.13990000e+04 1.17336160e+07]]
IOUs:  [0.94477152 0.37010185 0.46060534] , mean:  0.5918262350787029
Epoch 14:
Epoch stats:
[[2.5367780e+08 8.6718400e+05 9.1338310e+06]
 [4.2202900e+05 8.3967800e+05 7.6089000e+04]
 [4.3551590e+06 6.9877000e+04 1.1904401e+07]]
IOUs:  [0.94495112 0.36911243 0.46611984] , mean:  0.5933944631836322
Epoch 15:
Epoch stats:
[[2.53869003e+08 8.62222000e+05 8.94759000e+06]
 [4.07142000e+05 8.55088000e+05 7.55660000e+04]
 [4.32787000e+06 6.42190000e+04 1.19373480e+07]]
IOUs:  [0.94581194 0.37764951 0.47085314] , mean:  0.5981048646990429
Evaluation stats:
[[6.3923311e+07 2.8492500e+05 2.6336480e+06]
 [8.5335000e+04 1.9410600e+05 9.1100000e+03]
 [1.0004530e+06 1.7434000e+04 2.6305580e+06]]
IOUs:  [0.94104964 0.32848657 0.41813275] , mean:  0.5625563185443295
evaluating on test data...
Evaluation stats:
[[4.8593923e+07 1.9707300e+05 1.8633060e+06]
 [1.1618300e+05 1.7734700e+05 3.0640000e+03]
 [1.0231140e+06 1.5769000e+04 1.9791170e+06]]
IOUs:  [0.93822256 0.3481242  0.40519391] , mean:  0.563846891228434
identifying connected components..
tracking components across time..
num TCs: 10
num ARs: 19
Error when analyzing events :  [Errno 13] Permission denied: '/cluster/scratch/checkpoints/cgnet/results'
--------------------------------------------------
visualizing inference events...
--------------------------------------------------


Visualizing events...
Error when visualizing events of inference :  [Errno 13] Permission denied: '/cluster/scratch/checkpoints/cgnet/pngs'




traceback :  Traceback (most recent call last):
  File "/cluster/scratch/atabin/miniconda3/envs/climatenet/lib/python3.10/pathlib.py", line 1175, in mkdir
    self._accessor.mkdir(self, mode)
PermissionError: [Errno 13] Permission denied: '/cluster/scratch/checkpoints/cgnet/pngs'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/cluster/scratch/atabin/ClimateNet_AI4Good/./train.py", line 69, in run
    visualize_events(event_masks, inference, save_dir + 'pngs/')
  File "/cluster/scratch/atabin/ClimateNet_AI4Good/climatenet/visualize_events.py", line 27, in visualize_events
    pathlib.Path(png_dir).mkdir(parents=True, exist_ok=True)
  File "/cluster/scratch/atabin/miniconda3/envs/climatenet/lib/python3.10/pathlib.py", line 1184, in mkdir
    if not exist_ok or not self.is_dir():
  File "/cluster/scratch/atabin/miniconda3/envs/climatenet/lib/python3.10/pathlib.py", line 1305, in is_dir
    return S_ISDIR(self.stat().st_mode)
  File "/cluster/scratch/atabin/miniconda3/envs/climatenet/lib/python3.10/pathlib.py", line 1097, in stat
    return self._accessor.stat(self, follow_symlinks=follow_symlinks)
PermissionError: [Errno 13] Permission denied: '/cluster/scratch/checkpoints/cgnet/pngs'

