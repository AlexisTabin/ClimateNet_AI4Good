self.device :  cuda
train_path :  /cluster/work/igp_psr/ai4good/group-1b/data/train/
val_path :  /cluster/work/igp_psr/ai4good/group-1b/data/val/
inference_path :  /cluster/work/igp_psr/ai4good/group-1b/data/test/
Loading data...
|===========================================================================|
|                  PyTorch CUDA memory summary, device ID 0                 |
|---------------------------------------------------------------------------|
|            CUDA OOMs: 0            |        cudaMalloc retries: 0         |
|===========================================================================|
|        Metric         | Cur Usage  | Peak Usage | Tot Alloc  | Tot Freed  |
|---------------------------------------------------------------------------|
| Allocated memory      |  104936 KB |  104936 KB |  104936 KB |       0 B  |
|       from large pool |  102016 KB |  102016 KB |  102016 KB |       0 B  |
|       from small pool |    2920 KB |    2920 KB |    2920 KB |       0 B  |
|---------------------------------------------------------------------------|
| Active memory         |  104936 KB |  104936 KB |  104936 KB |       0 B  |
|       from large pool |  102016 KB |  102016 KB |  102016 KB |       0 B  |
|       from small pool |    2920 KB |    2920 KB |    2920 KB |       0 B  |
|---------------------------------------------------------------------------|
| GPU reserved memory   |  120832 KB |  120832 KB |  120832 KB |       0 B  |
|       from large pool |  116736 KB |  116736 KB |  116736 KB |       0 B  |
|       from small pool |    4096 KB |    4096 KB |    4096 KB |       0 B  |
|---------------------------------------------------------------------------|
| Non-releasable memory |   15896 KB |   23021 KB |   51003 KB |   35107 KB |
|       from large pool |   14720 KB |   22144 KB |   47488 KB |   32768 KB |
|       from small pool |    1176 KB |    2043 KB |    3515 KB |    2339 KB |
|---------------------------------------------------------------------------|
| Allocations           |     130    |     130    |     130    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |     117    |     117    |     117    |       0    |
|---------------------------------------------------------------------------|
| Active allocs         |     130    |     130    |     130    |       0    |
|       from large pool |      13    |      13    |      13    |       0    |
|       from small pool |     117    |     117    |     117    |       0    |
|---------------------------------------------------------------------------|
| GPU reserved segments |       8    |       8    |       8    |       0    |
|       from large pool |       6    |       6    |       6    |       0    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Non-releasable allocs |       3    |       4    |       5    |       2    |
|       from large pool |       1    |       3    |       3    |       2    |
|       from small pool |       2    |       2    |       2    |       0    |
|---------------------------------------------------------------------------|
| Oversize allocations  |       0    |       0    |       0    |       0    |
|---------------------------------------------------------------------------|
| Oversize GPU segments |       0    |       0    |       0    |       0    |
|===========================================================================|

Epoch 1:
Epoch stats:
[[2.42243462e+08 1.12571600e+06 2.03096370e+07]
 [1.07417300e+06 4.60500000e+03 2.59018000e+05]
 [6.48253100e+06 2.85870000e+04 9.81831900e+06]]
IOUs:  [0.89311113 0.00184784 0.26609286] , mean:  0.3870172795725759
Epoch 2:
Epoch stats:
[[2.52378001e+08 0.00000000e+00 1.13008140e+07]
 [1.14032200e+06 0.00000000e+00 1.97474000e+05]
 [6.49057500e+06 0.00000000e+00 9.83886200e+06]]
IOUs:  [0.93022103 0.         0.35356329] , mean:  0.42792810815728727
Epoch 3:
Epoch stats:
[[2.5252028e+08 7.5291000e+04 1.1083244e+07]
 [1.1159220e+06 7.1055000e+04 1.5081900e+05]
 [6.1188780e+06 1.4906000e+04 1.0195653e+07]]
IOUs:  [0.93210627 0.04975865 0.36989689] , mean:  0.4505872709900766
Epoch 4:
Epoch stats:
[[2.5234444e+08 3.7348800e+05 1.0960887e+07]
 [9.9217400e+05 2.3280500e+05 1.1281700e+05]
 [5.9147240e+06 4.8252000e+04 1.0366461e+07]]
IOUs:  [0.93258597 0.13231045 0.37829463] , mean:  0.4810636827637936
Epoch 5:
Epoch stats:
[[2.52447545e+08 6.25295000e+05 1.06059750e+07]
 [7.95729000e+05 4.35510000e+05 1.06557000e+05]
 [5.84959200e+06 7.30580000e+04 1.04067870e+07]]
IOUs:  [0.93386979 0.21388906 0.38483836] , mean:  0.5108657384554132
Epoch 6:
Epoch stats:
[[2.52187205e+08 8.24267000e+05 1.06673430e+07]
 [6.03255000e+05 6.45975000e+05 8.85660000e+04]
 [5.75839000e+06 7.30700000e+04 1.04979770e+07]]
IOUs:  [0.93388674 0.28900965 0.38758881] , mean:  0.53682839897363
Epoch 7:
Epoch stats:
[[2.52088351e+08 8.88378000e+05 1.07020860e+07]
 [5.39783000e+05 7.19724000e+05 7.82890000e+04]
 [5.52620700e+06 7.28210000e+04 1.07304090e+07]]
IOUs:  [0.93454386 0.31306027 0.39581274] , mean:  0.5478056240365913
Epoch 8:
Epoch stats:
[[2.52037815e+08 9.78223000e+05 1.06627770e+07]
 [5.03052000e+05 7.53908000e+05 8.08360000e+04]
 [5.54542200e+06 6.38950000e+04 1.07201200e+07]]
IOUs:  [0.93441719 0.31677951 0.39597016] , mean:  0.5490556214696048
Epoch 9:
Epoch stats:
[[2.5230103e+08 8.8290600e+05 1.0494879e+07]
 [5.2294400e+05 7.3545300e+05 7.9399000e+04]
 [5.4669420e+06 7.1223000e+04 1.0791272e+07]]
IOUs:  [0.93559627 0.32088877 0.40110713] , mean:  0.5525307243165233
Epoch 10:
Epoch stats:
[[2.5247357e+08 1.0151310e+06 1.0190114e+07]
 [4.9610100e+05 7.5669200e+05 8.5003000e+04]
 [5.4913590e+06 6.9233000e+04 1.0768845e+07]]
IOUs:  [0.93624451 0.3124038  0.4047745 ] , mean:  0.5511409383667262
Epoch 11:
Epoch stats:
[[2.52634879e+08 8.93811000e+05 1.01501250e+07]
 [5.01114000e+05 7.56071000e+05 8.06110000e+04]
 [5.40028200e+06 6.30550000e+04 1.08661000e+07]]
IOUs:  [0.93714178 0.32949123 0.40911255] , mean:  0.5585818515833753
Epoch 12:
Epoch stats:
[[2.52810873e+08 8.75731000e+05 9.99221100e+06]
 [4.90167000e+05 7.68581000e+05 7.90480000e+04]
 [5.37917200e+06 6.84680000e+04 1.08817970e+07]]
IOUs:  [0.93790616 0.33680223 0.41217841] , mean:  0.5622955992496658
Epoch 13:
Epoch stats:
[[2.52309595e+08 9.03114000e+05 1.04661060e+07]
 [4.72089000e+05 7.92796000e+05 7.29110000e+04]
 [5.23274200e+06 6.71940000e+04 1.10295010e+07]]
IOUs:  [0.93661809 0.34348366 0.41050002] , mean:  0.5635339219064525
Epoch 14:
Epoch stats:
[[2.52650816e+08 9.37926000e+05 1.00900730e+07]
 [4.86016000e+05 7.78858000e+05 7.29220000e+04]
 [5.20789300e+06 7.33000000e+04 1.10482440e+07]]
IOUs:  [0.93792279 0.33156692 0.41703397] , mean:  0.5621745592816976
Epoch 15:
Epoch stats:
[[2.5269628e+08 9.3671100e+05 1.0045824e+07]
 [4.8602900e+05 7.7671600e+05 7.5051000e+04]
 [5.1963840e+06 7.2027000e+04 1.1061026e+07]]
IOUs:  [0.9381316  0.33100564 0.41818131] , mean:  0.5624395170143076
Evaluation stats:
[[6.3406813e+07 5.2949200e+05 2.9055790e+06]
 [6.5061000e+04 2.1898400e+05 4.5060000e+03]
 [1.0149900e+06 2.0830000e+04 2.6126250e+06]]
IOUs:  [0.93352483 0.26104547 0.39835527] , mean:  0.5309751927932489
evaluating on test data...
Evaluation stats:
[[4.8253036e+07 3.5709300e+05 2.0441730e+06]
 [8.8203000e+04 2.0595700e+05 2.4340000e+03]
 [9.5331600e+05 2.1488000e+04 2.0431960e+06]]
IOUs:  [0.93340303 0.3050424  0.40342637] , mean:  0.5472905979139573
identifying connected components..
tracking components across time..
num TCs: 14
num ARs: 22
calculating centroids..
extracting event types..
calculating genesis and termination frequencies..
generating histograms..
Error when analyzing events :  Longitude 358.9609866906144 is out of range [-180, 180]
--------------------------------------------------
visualizing inference events...
--------------------------------------------------


Visualizing events...
generating images..
Type event masks: <class 'numpy.ndarray'>
Shape event masks: (61, 768, 1152)
Type data: <class 'xarray.core.dataarray.DataArray'>
Type selected_data: <class 'xarray.core.dataarray.DataArray'>
Shape selected_data: (1, 768, 1152)
selected_data:  <xarray.DataArray (time: 1, lat: 768, lon: 1152)>
array([[[-1.1946713 , -1.1946713 , -1.1946713 , ..., -1.1946713 ,
         -1.1946713 , -1.1946713 ],
        [-1.1953546 , -1.1953639 , -1.1953733 , ..., -1.1953275 ,
         -1.1953363 , -1.1953453 ],
        [-1.1956391 , -1.1956526 , -1.1956663 , ..., -1.1955986 ,
         -1.1956123 , -1.1956258 ],
        ...,
        [-0.86728716, -0.86706686, -0.8668447 , ..., -0.86796397,
         -0.8677356 , -0.8675106 ],
        [-0.86832696, -0.8682125 , -0.86809796, ..., -0.86866885,
         -0.86855406, -0.86844045],
        [-0.8676587 , -0.8676587 , -0.8676587 , ..., -0.8676587 ,
         -0.8676587 , -0.8676587 ]]], dtype=float32)
Coordinates:
  * lat       (lat) float64 -90.0 -89.77 -89.53 -89.3 ... 89.3 89.53 89.77 90.0
  * lon       (lon) float64 0.0 0.3125 0.625 0.9375 ... 358.8 359.1 359.4 359.7
  * time      (time) object 'data-2011-06-01-01-1.nc'
    variable  <U3 'TMQ'
Selector: 0
Type nxt: <class 'xarray.core.dataarray.DataArray'>
Shape nxt: (768, 1152)
Generating PNG for  ./checkpoints/unet/pngs/0000.png
Contouring...
Error when visualizing events of inference :  'GeoAxesSubplot' object has no attribute '_autoscaleXon'




traceback :  Traceback (most recent call last):
  File "/cluster/scratch/atabin/ClimateNet_AI4Good/./train.py", line 68, in run
    visualize_events(event_masks, inference, save_dir + 'pngs/')
  File "/cluster/scratch/atabin/ClimateNet_AI4Good/climatenet/visualize_events.py", line 134, in visualize_events
    spawn(i)
  File "/cluster/scratch/atabin/ClimateNet_AI4Good/climatenet/visualize_events.py", line 127, in spawn
    generatePNG(filename, nxt, masks)
  File "/cluster/scratch/atabin/ClimateNet_AI4Good/climatenet/visualize_events.py", line 77, in generatePNG
    data_contour = mymap.contourf(lon, lat, tmq_data, 128, vmin=0, vmax=89, cmap=data_cmap,
  File "/cluster/scratch/atabin/miniconda3/envs/climatenet/lib/python3.10/site-packages/cartopy/mpl/geoaxes.py", line 310, in wrapper
    return func(self, *args, **kwargs)
  File "/cluster/scratch/atabin/miniconda3/envs/climatenet/lib/python3.10/site-packages/cartopy/mpl/geoaxes.py", line 1508, in contourf
    result = matplotlib.axes.Axes.contourf(self, *args, **kwargs)
  File "/cluster/scratch/atabin/miniconda3/envs/climatenet/lib/python3.10/site-packages/matplotlib/__init__.py", line 1423, in inner
    return func(ax, *map(sanitize_sequence, args), **kwargs)
  File "/cluster/scratch/atabin/miniconda3/envs/climatenet/lib/python3.10/site-packages/matplotlib/axes/_axes.py", line 6414, in contourf
    contours = mcontour.QuadContourSet(self, *args, **kwargs)
  File "/cluster/scratch/atabin/miniconda3/envs/climatenet/lib/python3.10/site-packages/matplotlib/contour.py", line 902, in __init__
    self.axes.autoscale_view(tight=True)
  File "/cluster/scratch/atabin/miniconda3/envs/climatenet/lib/python3.10/site-packages/cartopy/mpl/geoaxes.py", line 857, in autoscale_view
    if scalex and self._autoscaleXon:
AttributeError: 'GeoAxesSubplot' object has no attribute '_autoscaleXon'

